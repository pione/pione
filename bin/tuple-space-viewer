#!/usr/bin/env ruby
# -*- ruby -*-

require 'innocent-white/tuple'
require 'innocent-white/agent'
require 'innocent-white/process-handler'
require 'innocent-white/tuple-space-provider'

# start druby environment
DRb.start_service

# tuple space provider
provider = InnocentWhite::TupleSpaceProvider.get

# tuple space servers are not found
if provider.tuple_space_servers.empty?
  puts "No tuple space servers."
  exit 0
end

# print tuples
provider.tuple_space_servers.each do |ts_server|
  puts "TupleSpaceServer: #{ts_server.uuid}"
  ts_server.all_tuples.each do |tuple|
    puts tuple.value.map{|v|v.inspect}.join(",")
  end
end
