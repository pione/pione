#!/usr/bin/env ruby
# -*- ruby -*-

require 'pione/common'
require 'pione/tuple-space-receiver'
require 'pione/agent/broker'

Thread.abort_on_exception = true

Pione.debug_mode = true
#Pione.set_signal_trap

# tuple space receiver
receiver = Pione::TupleSpaceReceiver.instance

# broker
broker = Pione::Agent[:broker].new(task_worker_resource: 4)

# regist broker
receiver.register(broker)

# wait
DRb.thread.join
